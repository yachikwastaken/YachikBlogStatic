(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[175],{9072:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(5893);s(3804);const a=new Map([["success","check"],["info","info"],["warning","exclamation-triangle"],["danger","times-circle"]]),n=e=>{const{type:t}=e,s=a.get(t);return e.children?(0,i.jsxs)("div",Object.assign({className:"alert alert-"+t},{children:[(0,i.jsx)("i",{className:"icon fas fa-"+s},void 0),e.children]}),void 0):null}},7694:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(5944),a=s(3804),n=s(7745),o=s.n(n),r=s(3601),c=s(88),l=s(6051);const u=Symbol();class d extends a.Component{constructor(e){super(e),this.execute=async()=>{const e=this.ref.current;return e&&this.state.invisible?new Promise((t=>{const s=(0,r.on)(u,(e=>{t(e),s()}));e.execute()})):this.state.value},this.reset=()=>{const e=this.ref.current;e?e.reset():this.setState({time:Date.now()})},this.handleValueChange=e=>{this.setState({value:e.target.value})},this.handleVerify=e=>{(0,r.j)(u,e),this.setState({value:e})},this.handleRefresh=()=>{this.setState({time:Date.now()})},this.state={value:"",time:Date.now(),sitekey:blessing.extra.recaptcha,invisible:blessing.extra.invisible},this.ref=a.createRef()}render(){return this.state.sitekey?(0,i.tZ)("div",Object.assign({className:"mb-2"},{children:(0,i.tZ)(o(),{ref:this.ref,sitekey:this.state.sitekey,size:this.state.invisible?"invisible":"normal",onVerify:this.handleVerify},void 0)}),void 0):(0,i.BX)("div",Object.assign({className:"d-flex"},{children:[(0,i.tZ)("div",Object.assign({className:"form-group mb-3 mr-2"},{children:(0,i.tZ)("input",{type:"text",className:"form-control",placeholder:(0,c.t)("auth.captcha"),required:!0,value:this.state.value,onChange:this.handleValueChange},void 0)}),void 0),(0,i.tZ)("img",{src:`${blessing.base_url}/auth/captcha?v=${this.state.time}`,alt:(0,c.t)("auth.captcha"),css:l.G,height:34,title:(0,c.t)("auth.change-captcha"),onClick:this.handleRefresh},void 0)]}),void 0)}}const h=d},2982:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(5944),a=s(3804),n=s(8808),o=s.n(n),r=s(917),c=s(3601),l=s(6051);const u=r.iv`
  .dropdown-menu li {
    ${l.G}
  }
`,d=new Set(["qq.com","163.com","gmail.com","hotmail.com"]),h=e=>{const[t,s]=(0,a.useState)([]);return(0,a.useEffect)((()=>{(0,c.j)("emailDomainsSuggestion",d)}),[]),(0,i.tZ)("div",Object.assign({css:u},{children:(0,i.tZ)(o(),{suggestions:t,onSuggestionsFetchRequested:({value:e})=>{const t=e.split("@");s([...d].map((e=>`${t[0]}@${e}`)))},onSuggestionsClearRequested:()=>{s([])},getSuggestionValue:e=>e,renderSuggestion:e=>e,shouldRenderSuggestions:e=>[...d].some((t=>e.endsWith("@"+t)))||e.length>0&&!e.includes("@"),inputProps:Object.assign({},e,{onChange:(t,s)=>{e.onChange(s.newValue)}}),renderInputComponent:e=>(0,i.BX)("div",Object.assign({className:"input-group"},{children:[(0,i.tZ)("input",Object.assign({className:"form-control"},e),void 0),(0,i.tZ)("div",Object.assign({className:"input-group-append"},{children:(0,i.tZ)("div",Object.assign({className:"input-group-text"},{children:(0,i.tZ)("i",{className:"fas fa-envelope"},void 0)}),void 0)}),void 0)]}),void 0),theme:{container:"mb-3",suggestion:"dropdown-item",suggestionsContainer:"dropdown",suggestionsList:"dropdown-menu "+(t.length?"show":""),suggestionHighlighted:"active"}},void 0)}),void 0)}},9341:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(3804);function a(e,t){const[s,a]=(0,i.useState)(t);return(0,i.useEffect)((()=>{a(blessing.extra[e])}),[]),s}},9018:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(3804),a=s(3601);function n(){(0,i.useEffect)((()=>{(0,a.j)("mounted")}),[])}},6051:(e,t,s)=>{"use strict";s.d(t,{G:()=>a,b:()=>n});var i=s(917);const a=i.iv`
  cursor: pointer;
`,n=i.iv`
  display: flex;
  justify-content: center;
  align-items: center;
`},9175:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var i=s(5893),a=s(3804),n=s(1570),o=s(9341),r=s(9018),c=s(88),l=s(6703),u=s(439),d=s(8848),h=s(9072),g=s(7694),v=s(2982);const p=(0,n.w)((()=>{const[e,t]=(0,a.useState)(""),[s,n]=(0,a.useState)(""),[p,m]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[j,x]=(0,a.useState)(!1),[w,y]=(0,a.useState)(""),Z=(0,a.useRef)(null),S=(0,o.Z)("recaptcha"),k=(0,o.Z)("invisible");return(0,r.Z)(),(0,a.useEffect)((()=>{b(blessing.extra.tooManyFails)}),[]),(0,i.jsxs)("form",Object.assign({onSubmit:async t=>{var i;t.preventDefault(),x(!0);const a=await l.v_(d.Z.auth.login(),{identification:e,password:s,keep:p,captcha:f?await Z.current.execute():void 0});!function(e){return 0===e.code}(a)?(y(a.message),x(!1),null===(i=Z.current)||void 0===i||i.reset(),a.data.login_fails>3&&!f&&(b(!0),S?k||(0,u.K)({mode:"alert",text:(0,c.t)("auth.tooManyFails.recaptcha")}):(0,u.K)({mode:"alert",text:(0,c.t)("auth.tooManyFails.captcha")}))):window.location.href=a.data.redirectTo}},{children:[(0,i.jsx)(v.Z,{type:"text",placeholder:(0,c.t)("auth.identification"),required:!0,autoFocus:!0,value:e,onChange:t},void 0),(0,i.jsxs)("div",Object.assign({className:"input-group mb-3"},{children:[(0,i.jsx)("input",{type:"password",className:"form-control",placeholder:(0,c.t)("auth.password"),autoComplete:"current-password",value:s,onChange:e=>{n(e.target.value)},required:!0},void 0),(0,i.jsx)("div",Object.assign({className:"input-group-append"},{children:(0,i.jsx)("div",Object.assign({className:"input-group-text"},{children:(0,i.jsx)("i",{className:"fas fa-lock"},void 0)}),void 0)}),void 0)]}),void 0),f&&(0,i.jsx)(g.Z,{ref:Z},void 0),(0,i.jsx)(h.Z,Object.assign({type:"warning"},{children:w}),void 0),(0,i.jsxs)("div",Object.assign({className:"d-flex justify-content-between mb-3"},{children:[(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",className:"mr-1",checked:p,onChange:e=>{m(e.target.checked)}},void 0),(0,c.t)("auth.keep")]},void 0),(0,i.jsx)("a",Object.assign({href:blessing.base_url+"/auth/forgot"},{children:(0,c.t)("auth.forgot-link")}),void 0)]}),void 0),(0,i.jsx)("button",Object.assign({className:"btn btn-primary btn-block",type:"submit",disabled:j},{children:j?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("i",{className:"fas fa-spinner fa-spin mr-1"},void 0),(0,c.t)("auth.loggingIn")]},void 0):(0,c.t)("auth.login")}),void 0)]}),void 0)}))}}]);