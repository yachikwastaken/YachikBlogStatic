(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[512],{3291:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var i=t(5893);t(3804);const a=e=>(0,i.jsx)("a",Object.assign({href:"#",title:e.title,className:"ml-2",onClick:e.onClick},{children:(0,i.jsx)("i",{className:"fas fa-edit"},void 0)}),void 0)},5996:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var i=t(5893);t(3804);const a=()=>(0,i.jsx)("div",Object.assign({className:"container text-center",title:"Loading..."},{children:(0,i.jsx)("i",{className:"fas fa-sync fa-spin"},void 0)}),void 0)},6309:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var i=t(5893),a=(t(3804),t(88));const n=()=>(0,i.jsxs)("div",Object.assign({className:"card"},{children:[(0,i.jsx)("div",Object.assign({className:"card-header"},{children:(0,i.jsx)("div",Object.assign({className:"d-flex justify-content-between"},{children:(0,i.jsx)("h3",Object.assign({className:"card-title"},{children:(0,i.jsx)("span",{children:(0,a.t)("general.texturePreview")},void 0)}),void 0)}),void 0)}),void 0),(0,i.jsx)("div",{className:"card-body"},void 0)]}),void 0)},9341:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var i=t(3804);function a(e,s){const[t,a]=(0,i.useState)(s);return(0,i.useEffect)((()=>{a(blessing.extra[e])}),[]),t}},9018:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var i=t(3804),a=t(3601);function n(){(0,i.useEffect)((()=>{(0,a.j)("mounted")}),[])}},9683:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var i=t(3804);function a(e){const s=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const t=document.querySelector(e),i=document.createElement("div");return s.current=i,t.appendChild(i),()=>{t.removeChild(i),s.current=null}}),[]),s.current}},7109:(e,s,t)=>{"use strict";var i,a;t.d(s,{P:()=>i,N:()=>a}),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(i||(i={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(a||(a={}))},7920:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var i=t(88),a=t(6703),n=t(439),c=t(8848);async function l(e){let s;try{const{value:t}=await(0,n.K)({mode:"prompt",title:(0,i.t)("skinlib.setItemName"),text:(0,i.t)("skinlib.applyNotice"),input:e.name,validator:e=>{if(!e)return(0,i.t)("skinlib.emptyItemName")}});s=t}catch(e){return!1}const{code:t,message:l}=await a.v_(c.Z.user.closet.add(),{tid:e.tid,name:s});return 0===t?n.A.success(l):n.A.error(l),0===t}},8512:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var i=t(5893),a=t(3804),n=t.n(a),c=t(7196),l=t(1570),r=t(1655),o=t(9341),d=t(9018),b=t(9683),v=t(88),u=t(6703),m=t(439),j=t(7109),h=t(8848),x=t(3291),g=t(6309),p=t(666),N=t(5667),k=t(5743),w=t(7920);const O=n().lazy((()=>Promise.all([t.e(574),t.e(308),t.e(42)]).then(t.bind(t,617)))),y=(0,l.w)((()=>{const[e,s]=(0,a.useState)({}),[t,l]=(0,a.useState)(!0),[y,f]=(0,a.useState)(!1),[Z,C]=(0,a.useState)(!1),A=(0,o.Z)("nickname"),S=(0,o.Z)("uploaderExists"),_=(0,o.Z)("currentUid",0),P=(0,o.Z)("admin"),T=(0,o.Z)("badges",[]),$=(0,o.Z)("download"),E=(0,o.Z)("report"),K=(0,b.Z)("#previewer");(0,d.Z)(),(0,a.useEffect)((()=>{(async()=>{const e=location.href.replace(blessing.base_url,"").replace("skinlib/show","texture"),t=await u.U2(e);s(t),l(!1)})()}),[]),(0,a.useEffect)((()=>{C(blessing.extra.inCloset)}),[]);const F=(()=>{var s;const t=new URLSearchParams;return t.append("filter",e.type===j.N.Cape?j.N.Cape:"skin"),t.append("uploader",null===(s=e.uploader)||void 0===s?void 0:s.toString()),`${blessing.base_url}/skinlib?${t.toString()}`})(),z=_===e.uploader||P,B=`${blessing.base_url}/textures/${e.hash}`;return(0,i.jsxs)(i.Fragment,{children:[K&&(0,c.createPortal)((0,i.jsx)(n().Suspense,Object.assign({fallback:(0,i.jsx)(g.Z,{},void 0)},{children:(0,i.jsx)(O,Object.assign({},{[e.type===j.N.Cape?j.N.Cape:"skin"]:B},{isAlex:e.type===j.N.Alex,initPositionZ:60},{children:0===_?(0,i.jsx)("button",Object.assign({className:"btn btn-outline-secondary",title:(0,v.t)("skinlib.show.anonymous"),disabled:!0},{children:(0,v.t)("skinlib.addToCloset")}),void 0):(0,i.jsxs)("div",Object.assign({className:"d-flex justify-content-between align-items-center"},{children:[(0,i.jsxs)("div",{children:[Z&&(0,i.jsx)("button",Object.assign({className:"btn btn-outline-success mr-2",onClick:()=>f(!0)},{children:(0,v.t)("skinlib.apply")}),void 0),Z?(0,i.jsx)("button",Object.assign({className:"btn btn-outline-primary mr-2",onClick:async()=>{await(0,N.Z)(e.tid)&&(s((e=>Object.assign(Object.assign({},e),{likes:e.likes-1}))),C(!1))}},{children:(0,v.t)("skinlib.removeFromCloset")}),void 0):(0,i.jsx)("button",Object.assign({className:"btn btn-outline-primary mr-2",onClick:async()=>{await(0,w.Z)(e)&&(s((e=>Object.assign(Object.assign({},e),{likes:e.likes+1}))),C(!0))}},{children:(0,v.t)("skinlib.addToCloset")}),void 0),e.type!==j.N.Cape&&(0,i.jsx)("button",Object.assign({className:"btn btn-outline-info mr-2",onClick:()=>(0,k.Z)(e.tid)},{children:(0,v.t)("user.setAsAvatar")}),void 0),$&&(0,i.jsx)("button",Object.assign({className:"btn btn-outline-info mr-2",onClick:()=>{const s=document.createElement("a");s.href=`${blessing.base_url}/raw/${e.tid}`,s.download=e.name+".png",s.click()}},{children:(0,v.t)("skinlib.show.download")}),void 0),(0,i.jsx)("button",Object.assign({className:"btn btn-outline-info mr-2",onClick:async()=>{const s=E>0?(0,v.t)("skinlib.report.positive",{score:E}):E<0?(0,v.t)("skinlib.report.negative",{score:-E}):"";let t;try{const{value:e}=await(0,m.K)({mode:"prompt",title:(0,v.t)("skinlib.report.title"),text:s,placeholder:(0,v.t)("skinlib.report.reason")});t=e}catch(e){return}const{code:i,message:a}=await u.v_("/skinlib/report",{tid:e.tid,reason:t});0===i?m.A.success(a):m.A.error(a)}},{children:(0,v.t)("skinlib.report.title")}),void 0)]},void 0),(0,i.jsxs)("div",Object.assign({className:Z?"text-red":"text-gray",title:(0,v.t)("skinlib.show.likes")},{children:[(0,i.jsx)("i",{className:"fas fa-heart mr-1"},void 0),(0,i.jsx)("span",{children:e.likes},void 0)]}),void 0)]}),void 0)}),void 0)}),void 0),K),(0,i.jsxs)("div",Object.assign({className:"card card-primary"},{children:[(0,i.jsx)("div",Object.assign({className:"card-header"},{children:(0,i.jsx)("h3",Object.assign({className:"card-title"},{children:(0,v.t)("skinlib.show.detail")}),void 0)}),void 0),(0,i.jsx)("div",Object.assign({className:"card-body"},{children:(0,i.jsxs)("div",Object.assign({className:"container"},{children:[(0,i.jsxs)("div",Object.assign({className:"row mt-2 mb-4"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:(0,v.t)("skinlib.show.name")}),void 0),t?(0,i.jsx)("div",Object.assign({className:"col-8"},{children:(0,i.jsx)(r.ZP,{},void 0)}),void 0):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",Object.assign({className:"col-7 text-truncate",title:e.name},{children:e.name}),void 0),z&&(0,i.jsx)("div",Object.assign({className:"col-1"},{children:(0,i.jsx)(x.Z,{title:(0,v.t)("skinlib.show.edit"),onClick:async()=>{let t;try{const{value:s}=await(0,m.K)({mode:"prompt",text:(0,v.t)("skinlib.setNewTextureName"),input:e.name,validator:e=>{if(!e)return(0,v.t)("skinlib.emptyNewTextureName")}});t=s}catch(e){return}const{code:i,message:a}=await u.gz(h.Z.texture.name(e.tid),{name:t});0===i?(m.A.success(a),s((e=>Object.assign(Object.assign({},e),{name:t})))):m.A.error(a)}},void 0)}),void 0)]},void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"row my-4"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:(0,v.t)("skinlib.show.model")}),void 0),t?(0,i.jsx)("div",Object.assign({className:"col-8"},{children:(0,i.jsx)(r.ZP,{},void 0)}),void 0):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",Object.assign({className:"col-7"},{children:e.type===j.N.Cape?(0,v.t)("general.cape"):e.type}),void 0),z&&(0,i.jsx)("div",Object.assign({className:"col-1"},{children:(0,i.jsx)(x.Z,{title:(0,v.t)("skinlib.show.edit"),onClick:async()=>{let t;try{const{value:s}=await(0,m.K)({mode:"prompt",text:(0,v.t)("skinlib.setNewTextureModel"),input:e.type,inputType:"radios",choices:[{text:"Steve",value:j.N.Steve},{text:"Alex",value:j.N.Alex},{text:(0,v.t)("general.cape"),value:j.N.Cape}]});t=s}catch(e){return}const{code:i,message:a}=await u.gz(h.Z.texture.type(e.tid),{type:t});0===i?(m.A.success(a),s((e=>Object.assign(Object.assign({},e),{type:t})))):m.A.error(a)}},void 0)}),void 0)]},void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"row my-4"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:"Hash"}),void 0),(0,i.jsx)("div",Object.assign({className:"col-8 text-truncate user-select-all",title:e.hash},{children:t?(0,i.jsx)(r.ZP,{},void 0):e.hash}),void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"row my-4"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:(0,v.t)("skinlib.show.size")}),void 0),(0,i.jsx)("div",Object.assign({className:"col-8"},{children:t?(0,i.jsx)(r.ZP,{},void 0):(0,i.jsxs)("span",{children:[e.size," KB"]},void 0)}),void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"row my-4"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:(0,v.t)("skinlib.show.uploader")}),void 0),(0,i.jsx)("div",Object.assign({className:"col-8 text-truncate"},{children:t?(0,i.jsx)(r.ZP,{},void 0):S?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)("a",Object.assign({href:F,target:"_blank"},{children:A}),void 0)},void 0),(0,i.jsx)("div",{children:T.map((e=>(0,i.jsx)("span",Object.assign({className:`badge bg-${e.color} mr-2`},{children:e.text}),e.text)))},void 0)]},void 0):A}),void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"row mt-4 mb-2"},{children:[(0,i.jsx)("div",Object.assign({className:"col-4"},{children:(0,v.t)("skinlib.show.upload-at")}),void 0),(0,i.jsx)("div",Object.assign({className:"col-8"},{children:t?(0,i.jsx)(r.ZP,{},void 0):e.upload_at}),void 0)]}),void 0)]}),void 0)}),void 0)]}),void 0),z&&(0,i.jsxs)("div",Object.assign({className:"card card-warning"},{children:[(0,i.jsx)("div",Object.assign({className:"card-header"},{children:(0,i.jsx)("h3",Object.assign({className:"card-title"},{children:(0,v.t)("admin.operationsTitle")}),void 0)}),void 0),(0,i.jsx)("div",Object.assign({className:"card-body"},{children:(0,i.jsx)("p",{children:(0,v.t)("skinlib.show.manage-notice")},void 0)}),void 0),(0,i.jsx)("div",Object.assign({className:"card-footer"},{children:(0,i.jsxs)("div",Object.assign({className:"container d-flex justify-content-between"},{children:[(0,i.jsx)("button",Object.assign({className:"btn btn-warning",onClick:async()=>{try{await(0,m.K)({text:e.public?(0,v.t)("skinlib.setPrivateNotice"):(0,v.t)("skinlib.setPublicNotice")})}catch(e){return}const t=await u.gz(h.Z.texture.privacy(e.tid)),{code:i,message:a}=t;if(0===i)m.A.success(a),s((e=>Object.assign(Object.assign({},e),{public:!e.public})));else if(2===t.code)try{await(0,m.K)({mode:"confirm",text:a,okButtonText:(0,v.t)("user.viewInSkinlib")}),window.location.href=blessing.base_url+h.Z.skinlib.show(t.data.tid)}catch(e){}else m.A.error(a)}},{children:e.public?(0,v.t)("skinlib.setAsPrivate"):(0,v.t)("skinlib.setAsPublic")}),void 0),(0,i.jsx)("button",Object.assign({className:"btn btn-danger",onClick:async()=>{try{await(0,m.K)({text:(0,v.t)("skinlib.deleteNotice"),okButtonType:"danger"})}catch(e){return}const{code:s,message:t}=await u.IV(h.Z.texture.delete(e.tid));0===s?(m.A.success(t),setTimeout((()=>{window.location.href=blessing.base_url+"/skinlib"}),2e3)):m.A.error(t)}},{children:(0,v.t)("skinlib.show.delete-texture")}),void 0)]}),void 0)}),void 0)]}),void 0),(0,i.jsx)(p.Z,Object.assign({show:y,canAdd:!1},{[e.type===j.N.Cape?j.N.Cape:"skin"]:e.tid},{onClose:()=>f(!1)}),void 0)]},void 0)}))},666:(e,s,t)=>{"use strict";t.d(s,{Z:()=>m});var i=t(5893),a=t(3804),n=t(3609),c=t.n(n),l=t(88),r=t(6703),o=t(439),d=t(8848),b=t(5996),v=t(2794);const u=blessing.base_url,m=e=>{const[s,t]=(0,a.useState)([]),[n,m]=(0,a.useState)(""),[j,h]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{e.show&&(async()=>{h(!0);const e=await r.U2(d.Z.user.player.list());t(e),h(!1)})()}),[e.show]),(0,i.jsx)(v.Z,Object.assign({show:e.show,id:"modal-apply",title:(0,l.t)("user.closet.use-as.title"),flexFooter:!0,footer:(0,i.jsx)(i.Fragment,{},void 0),onClose:e.onClose},{children:j?(0,i.jsx)(b.Z,{},void 0):0===s.length?(0,i.jsx)("p",{children:(0,l.t)("user.closet.use-as.empty")},void 0):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",Object.assign({className:"form-group"},{children:(0,i.jsx)("input",{type:"text",className:"form-control",placeholder:(0,l.t)("user.typeToSearch"),onChange:e=>{m(e.target.value)}},void 0)}),void 0),s.filter((e=>e.name.includes(n))).map((s=>(0,i.jsxs)("button",Object.assign({className:"btn btn-block btn-outline-info text-left",title:s.name,onClick:()=>(async s=>{const{code:t,message:i}=await r.gz(d.Z.user.player.set(s.pid),{skin:e.skin,cape:e.cape});0===t?(o.A.success(i),c()("#modal-apply").modal("hide")):o.A.error(i)})(s)},{children:[(0,i.jsx)("img",{src:`${u}/avatar/${s.tid_skin}?3d&size=45`,alt:s.name,width:45,height:45},void 0),(0,i.jsx)("span",Object.assign({className:"ml-1"},{children:s.name}),void 0)]}),s.pid)))]},void 0)}),void 0)}},5667:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var i=t(88),a=t(6703),n=t(439),c=t(8848);async function l(e){try{await(0,n.K)({text:(0,i.t)("user.removeFromClosetNotice"),okButtonType:"danger"})}catch(e){return!1}const{code:s,message:t}=await a.IV(c.Z.user.closet.remove(e));return 0===s?n.A.success(t):n.A.error(t),0===s}},5743:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var i=t(88),a=t(6703),n=t(439),c=t(8848);async function l(e){try{await(0,n.K)({title:(0,i.t)("user.setAvatar"),text:(0,i.t)("user.setAvatarNotice")})}catch(e){return}const{code:s,message:t}=await a.v_(c.Z.user.profile.avatar(),{tid:e});0===s?(n.A.success(t),document.querySelectorAll('[alt="User Image"]').forEach((s=>{s.src=`${blessing.base_url}/avatar/${e}`}))):n.A.error(t)}}}]);