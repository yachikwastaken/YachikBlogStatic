(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[403],{3291:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(5893);t(3804);const i=e=>(0,a.jsx)("a",Object.assign({href:"#",title:e.title,className:"ml-2",onClick:e.onClick},{children:(0,a.jsx)("i",{className:"fas fa-edit"},void 0)}),void 0)},6309:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var a=t(5893),i=(t(3804),t(88));const n=()=>(0,a.jsxs)("div",Object.assign({className:"card"},{children:[(0,a.jsx)("div",Object.assign({className:"card-header"},{children:(0,a.jsx)("div",Object.assign({className:"d-flex justify-content-between"},{children:(0,a.jsx)("h3",Object.assign({className:"card-title"},{children:(0,a.jsx)("span",{children:(0,i.t)("general.texturePreview")},void 0)}),void 0)}),void 0)}),void 0),(0,a.jsx)("div",{className:"card-body"},void 0)]}),void 0)},9341:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(3804);function i(e,s){const[t,i]=(0,a.useState)(s);return(0,a.useEffect)((()=>{i(blessing.extra[e])}),[]),t}},9018:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var a=t(3804),i=t(3601);function n(){(0,a.useEffect)((()=>{(0,i.j)("mounted")}),[])}},9683:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(3804);function i(e){const s=(0,a.useRef)(null);return(0,a.useEffect)((()=>{const t=document.querySelector(e),a=document.createElement("div");return s.current=a,t.appendChild(a),()=>{t.removeChild(a),s.current=null}}),[]),s.current}},7109:(e,s,t)=>{"use strict";var a,i;t.d(s,{P:()=>a,N:()=>i}),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(a||(a={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(i||(i={}))},6051:(e,s,t)=>{"use strict";t.d(s,{G:()=>i,b:()=>n});var a=t(917);const i=a.iv`
  cursor: pointer;
`,n=a.iv`
  display: flex;
  justify-content: center;
  align-items: center;
`},403:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>$});var a=t(5893),i=t(3804),n=t.n(i),c=t(1570),r=t(9341),l=t(9018),d=t(6703),o=t(7109);function u(){const[e,s]=(0,i.useState)(0),[t,a]=(0,i.useState)(""),[n,c]=(0,i.useState)(o.N.Steve);return(0,i.useEffect)((()=>{e<=0?a(""):(async()=>{const{hash:s,type:t}=await d.U2("/skinlib/info/"+e);a(`${blessing.base_url}/textures/${s}`),c(t)})()}),[e]),[{url:t,type:n},s]}var v=t(88),h=t(439),j=t(8848),p=t(5944),m=t(917),x=t(3291),g=t(6051);const b=e=>{const{player:s}=e,t=e.selected&&m.iv`
      background-color: #efefef;
    `;return(0,p.BX)("tr",Object.assign({css:[g.G,t],onClick:e.onClick},{children:[(0,p.tZ)("td",{children:s.pid},void 0),(0,p.BX)("td",{children:[(0,p.tZ)("span",{children:s.name},void 0),(0,p.tZ)(x.Z,{title:(0,v.t)("user.player.edit-pname"),onClick:()=>{e.onEditName(s)}},void 0)]},void 0),(0,p.BX)("td",Object.assign({className:"d-flex"},{children:[(0,p.tZ)("button",Object.assign({className:"btn btn-warning",onClick:e.onReset},{children:(0,v.t)("user.player.delete-texture")}),void 0),(0,p.tZ)("button",Object.assign({className:"btn btn-danger ml-2",onClick:()=>{e.onDelete(s)}},{children:(0,v.t)("user.player.delete-player")}),void 0)]}),void 0)]}),void 0)};var y=t(574),f=t(1655);const N=y.Z.tr`
  height: 64px;
`,O=(0,y.Z)(f.ZP)`
  line-height: 2;
`,k=()=>(0,a.jsx)(N,{children:(0,a.jsx)("td",Object.assign({colSpan:3},{children:(0,a.jsx)(O,{},void 0)}),void 0)},void 0);var w=t(7196),C=t.n(w),S=t(9683),Z=t(6309);const A=y.Z.div`
  display: flex;
  justify-content: space-between;
  width: 80%;

  img {
    max-height: 64px;
    width: 64px;
  }
`,P=e=>(0,a.jsxs)("div",Object.assign({className:"card"},{children:[(0,a.jsx)("div",Object.assign({className:"card-header"},{children:(0,a.jsx)("h3",Object.assign({className:"card-title"},{children:(0,v.t)("general.texturePreview")}),void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"card-body"},{children:[(0,a.jsxs)(A,Object.assign({className:"mb-5"},{children:[(0,a.jsx)("span",{children:(0,v.t)("general.skin")},void 0),e.skin?(0,a.jsx)("img",{src:e.skin,alt:(0,v.t)("general.skin")},void 0):(0,a.jsx)("span",{children:(0,v.t)("user.player.texture-empty")},void 0)]}),void 0),(0,a.jsxs)(A,Object.assign({className:"mt-5"},{children:[(0,a.jsx)("span",{children:(0,v.t)("general.cape")},void 0),e.cape?(0,a.jsx)("img",{src:e.cape,alt:(0,v.t)("general.cape")},void 0):(0,a.jsx)("span",{children:(0,v.t)("user.player.texture-empty")},void 0)]}),void 0)]}),void 0),(0,a.jsx)("div",Object.assign({className:"card-footer"},{children:e.children}),void 0)]}),void 0),_=n().lazy((()=>Promise.all([t.e(308),t.e(617)]).then(t.bind(t,617)))),E=e=>{const[s,t]=(0,i.useState)(!0),c=(0,S.Z)("#previewer"),r=(0,a.jsx)("button",Object.assign({className:"btn btn-default",onClick:()=>t((e=>!e))},{children:s?(0,v.t)("user.switch2dPreview"):(0,v.t)("user.switch3dPreview")}),void 0),{skin:l,cape:d,isAlex:o}=e;return c&&C().createPortal(s?(0,a.jsx)(n().Suspense,Object.assign({fallback:(0,a.jsx)(Z.Z,{},void 0)},{children:(0,a.jsx)(_,Object.assign({skin:l,cape:d,isAlex:o},{children:r}),void 0)}),void 0):(0,a.jsx)(P,Object.assign({skin:l,cape:d},{children:r}),void 0),c)};var B=t(2794);const R=e=>{const[s,t]=(0,i.useState)(""),{score:n,cost:c,rule:r,length:l}=blessing.extra,o=n>=c;return(0,a.jsxs)(B.Z,Object.assign({show:e.show,title:(0,v.t)("user.player.add-player"),onConfirm:async()=>{const{code:t,message:a,data:i}=await d.v_(j.Z.user.player.add(),{name:s});0===t?(h.A.success(a),e.onAdd(i)):h.A.error(a)},onClose:()=>{t(""),e.onClose()}},{children:[(0,a.jsxs)("div",Object.assign({className:"form-group"},{children:[(0,a.jsx)("label",Object.assign({htmlFor:"new-player-name"},{children:(0,v.t)("general.player.player-name")}),void 0),(0,a.jsx)("input",{type:"text",className:"form-control",id:"new-player-name",value:s,onChange:e=>{t(e.target.value)}},void 0)]}),void 0),(0,a.jsx)("div",Object.assign({className:"callout callout-info"},{children:(0,a.jsxs)("ul",Object.assign({className:"m-0 p-0 pl-3"},{children:[(0,a.jsx)("li",{children:r},void 0),(0,a.jsx)("li",{children:l},void 0)]}),void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"alert alert-"+(o?"success":"danger"),role:"alert"},{children:[(0,a.jsx)("i",{className:"icon fas fa-"+(o?"check":"times")},void 0),(0,a.jsxs)("span",Object.assign({className:"ml-1"},{children:[(0,v.t)("user.cur-score")," ",n]}),void 0)]}),void 0)]}),void 0)},I=e=>{const[s,t]=(0,i.useState)(!1),[n,c]=(0,i.useState)(!1);return(0,a.jsxs)(B.Z,Object.assign({show:e.show,title:(0,v.t)("user.chooseClearTexture"),onConfirm:()=>{e.onSubmit(s,n)},onClose:()=>{t(!1),c(!1),e.onClose()}},{children:[(0,a.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,a.jsx)("input",{type:"checkbox",className:"mr-2",checked:s,onChange:e=>{t(e.target.checked)}},void 0),(0,v.t)("general.skin")]}),void 0),(0,a.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,a.jsx)("input",{type:"checkbox",className:"mr-2",checked:n,onChange:e=>{c(e.target.checked)}},void 0),(0,v.t)("general.cape")]}),void 0)]}),void 0)},$=(0,c.w)((()=>{const[e,s]=(0,i.useState)([]),[t,n]=(0,i.useState)(!0),[c,p]=(0,i.useState)(0),[m,x]=u(),[g,y]=u(),[f,N]=(0,i.useState)(""),[O,w]=(0,i.useState)(!1),[C,S]=(0,i.useState)(!1),Z=(0,r.Z)("count");(0,l.Z)();const A=e=>{p(e.pid),x(e.tid_skin),y(e.tid_cape)};(0,i.useEffect)((()=>{(async()=>{n(!0);const e=await d.U2("/user/player/list");s(e),1===e.length&&A(e[0]),n(!1)})()}),[]);const P=async e=>{try{await(0,h.K)({title:(0,v.t)("user.deletePlayer"),text:(0,v.t)("user.deletePlayerNotice"),okButtonType:"danger"})}catch(e){return}const{code:t,message:a}=await d.IV(j.Z.user.player.delete(e.pid));if(0===t){h.A.success(a);const{pid:t}=e;s((e=>e.filter((e=>e.pid!==t))))}else h.A.error(a)},_=()=>S(!0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",Object.assign({className:"card"},{children:[(0,a.jsx)("div",Object.assign({className:"card-header"},{children:(0,a.jsx)("input",{type:"text",className:"form-control",placeholder:(0,v.t)("user.typeToSearch"),onChange:e=>{N(e.target.value)}},void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:"card-body p-0 table-responsive"},{children:(0,a.jsxs)("table",Object.assign({className:"table table-hover"},{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",Object.assign({style:{width:"12%"}},{children:"PID"}),void 0),(0,a.jsx)("th",{children:(0,v.t)("general.player.player-name")},void 0),(0,a.jsx)("th",Object.assign({style:{width:"50%"}},{children:(0,v.t)("user.player.operation")}),void 0)]},void 0)},void 0),(0,a.jsx)("tbody",{children:t?new Array(Z).fill(null).map(((e,s)=>(0,a.jsx)(k,{},s))):0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",Object.assign({className:"text-center",colSpan:3},{children:(0,v.t)("general.noResult")}),void 0)},void 0):e.filter((({name:e})=>e.includes(f))).map(((e,t)=>(0,a.jsx)(b,{player:e,selected:c===e.pid,onClick:()=>A(e),onEditName:()=>(async(e,t)=>{let a;try{const{value:s}=await(0,h.K)({mode:"prompt",text:(0,v.t)("user.changePlayerName"),input:e.name,validator:e=>{if(!e)return(0,v.t)("user.emptyPlayerName")}});a=s}catch(e){return}const{code:i,message:n}=await d.gz(j.Z.user.player.rename(e.pid),{name:a});0===i?(h.A.success(n),s((s=>(s[t]=Object.assign(Object.assign({},e),{name:a}),s.slice())))):h.A.error(n)})(e,t),onReset:_,onDelete:P},e.pid)))},void 0)]}),void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:"card-footer"},{children:(0,a.jsxs)("button",Object.assign({className:"btn btn-primary",onClick:()=>w(!0)},{children:[(0,a.jsx)("i",{className:"fas fa-plus mr-1"},void 0),(0,a.jsx)("span",{children:(0,v.t)("user.player.add-player")},void 0)]}),void 0)}),void 0)]}),void 0),(0,a.jsx)(E,{skin:m.url,cape:g.url,isAlex:m.type===o.N.Alex},void 0),(0,a.jsx)(R,{show:O,onAdd:e=>{s((s=>[...s,e]))},onClose:()=>w(!1)},void 0),(0,a.jsx)(I,{show:C,onSubmit:async(e,t)=>{if(!e&&!t)return void h.A.warning((0,v.t)("user.noClearChoice"));const a=new URLSearchParams;e&&a.append("skin","true"),t&&a.append("cape","true");const{code:i,message:n}=await d.IV(`${j.Z.user.player.clear(c)}?${a.toString()}`);0===i?(h.A.success(n),e&&x(0),t&&y(0),s((s=>{const a=s.findIndex((e=>e.pid===c)),i=Object.assign({},s[a]);return e&&(i.tid_skin=0),t&&(i.tid_cape=0),s[a]=i,s.slice()}))):h.A.error(n)},onClose:()=>S(!1)},void 0)]},void 0)}))}}]);